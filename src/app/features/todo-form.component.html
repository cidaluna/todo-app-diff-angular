<div class="container">
  <h2>üìù Nova Tarefa</h2>
  <div class="top-bar-form">
    <button class="voltar" type="button" (click)="voltar()">Voltar</button>
  </div>
  <form [formGroup]="form" (ngSubmit)="saveAsDraft()">
    <label>
      T√≠tulo:
      <input formControlName="title" />
      <div *ngIf="form.get('title')?.touched && form.get('title')?.invalid">
        <div *ngIf="form.get('title')?.errors?.['required']">
          O t√≠tulo √© obrigat√≥rio.
        </div>
        <div *ngIf="form.get('title')?.errors?.['minlength']">
          O t√≠tulo deve ter no m√≠nimo 3 caracteres.
        </div>
      </div>
    </label>

    <label>
      Descri√ß√£o:
      <textarea formControlName="description"></textarea>
      <div *ngIf="form.get('description')?.touched && form.get('description')?.invalid">
        <div *ngIf="form.get('description')?.errors?.['required']">
          A descri√ß√£o √© obrigat√≥ria.
        </div>
        <div *ngIf="form.get('description')?.errors?.['minlength']">
          A descri√ß√£o deve ter no m√≠nimo 3 caracteres.
        </div>
      </div>
    </label>

    <h3>Subtarefas:</h3>
    <div formArrayName="subtasks">
      <div *ngFor="let subtask of subtasks.controls; let i = index" [formGroupName]="i">
        <input formControlName="title" placeholder="Descri√ß√£o da subtarefa" />
        <input type="checkbox" formControlName="done" />
        <button class="btn-remover" type="button" (click)="removeSubtask(i)">Remover</button>
      </div>
    </div>

    <button class="btn-adicionar" type="button" (click)="addSubtask()">+ Adicionar Subtarefa</button>

    <br /><br />
    <!-- Bot√£o Salvar como Rascunho: s√≥ aparece no modo cria√ß√£o -->
    <button
      *ngIf="!isEditing"
      [disabled]="perfilUsuario !== 'EDITOR' && form.invalid"
      class="btn-salvar-rascunho"
      type="submit">
      Salvar como Rascunho
    </button>
    <br /><br />
    <!-- Bot√£o Salvar para Aprova√ß√£o: EDITOR no modo edi√ß√£o -->
    <button
      *ngIf="isEditing && perfilUsuario === 'EDITOR'"
      [disabled]="form.invalid"
      class="btn-salvar-aprovacao"
      type="button"
      (click)="saveForApproval()">
      Salvar para Aprova√ß√£o
    </button>
    <br>

  </form>
</div>
